<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    
    <!-- Cache Control for immediate updates -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    
    <!-- DNS Prefetch for older browsers -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    
    <!-- Preconnect to establish early connection -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Non-blocking font loading using media trick -->
    <link 
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" 
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    >
    <noscript>
      <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    </noscript>
    <title>SwipeMatch - Find Your Perfect Rental Property or Tenant</title>
    <meta name="description" content="Discover your ideal rental property or tenant with SwipeMatch. Swipe through verified listings, connect with perfect matches, and find your next home or tenant effortlessly.">
    <meta name="author" content="SwipeMatch" />
    <meta name="keywords" content="rental, property, tenant, apartment, house, real estate, matching, swipe for rentals">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://swipematch.lovable.app/">
    <meta property="og:title" content="SwipeMatch - Find Your Perfect Rental Property or Tenant">
    <meta property="og:description" content="Discover your ideal rental property or tenant with SwipeMatch. Swipe through verified listings and connect with perfect matches.">
    <meta property="og:image" content="https://storage.googleapis.com/gpt-engineer-file-uploads/qyGlrqJHe9g2hyHsAc6ZZroRlyF2/social-images/social-1758515231924-ChatGPT Image Sep 21, 2025, 11_01_12 PM.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://swipematch.lovable.app/">
    <meta property="twitter:title" content="SwipeMatch - Find Your Perfect Rental Property or Tenant">
    <meta property="twitter:description" content="Discover your ideal rental property or tenant with SwipeMatch. Swipe through verified listings and connect with perfect matches.">
    <meta property="twitter:image" content="https://storage.googleapis.com/gpt-engineer-file-uploads/qyGlrqJHe9g2hyHsAc6ZZroRlyF2/social-images/social-1758515231924-ChatGPT Image Sep 21, 2025, 11_01_12 PM.png">
    
    <!-- PWA Support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#ff6b35">

    <!-- iOS/Safari PWA Support - Comprehensive Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SwipeMatch">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-touch-fullscreen" content="yes">

    <!-- Apple Touch Icons - All Required Sizes for iOS -->
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="1024x1024" href="/icons/apple-touch-icon-1024x1024.png">

    <!-- iOS Splash Screens (Launch Images) for all devices -->
    <!-- iPhone SE, 8, 7, 6s, 6 (4.7" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-750-1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)">
    <!-- iPhone 8 Plus, 7 Plus, 6s Plus, 6 Plus (5.5" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1242-2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone X, XS, 11 Pro (5.8" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1125-2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone XR, 11 (6.1" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-828-1792.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)">
    <!-- iPhone XS Max, 11 Pro Max (6.5" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1242-2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 12 mini, 13 mini (5.4" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1080-2340.png" media="(device-width: 360px) and (device-height: 780px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 12, 12 Pro, 13, 13 Pro, 14 (6.1" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1170-2532.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 12 Pro Max, 13 Pro Max, 14 Plus (6.7" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1284-2778.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 14 Pro (6.1" ProMotion display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1179-2556.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 14 Pro Max (6.7" ProMotion display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1290-2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 15, 15 Pro (6.1" Dynamic Island) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1179-2556.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPhone 15 Plus, 15 Pro Max (6.7" Dynamic Island) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1290-2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3)">
    <!-- iPad Mini (7.9" display) -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1536-2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)">
    <!-- iPad Air, iPad (10.2") -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1620-2160.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2)">
    <!-- iPad Pro 11" -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-1668-2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)">
    <!-- iPad Pro 12.9" -->
    <link rel="apple-touch-startup-image" href="/splash/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)">

    <!-- Capacitor iOS -->
    <meta name="supported-color-schemes" content="light dark">
    <meta name="color-scheme" content="light dark">
    
    <!-- Performance and Security -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <link rel="icon" type="image/x-icon" href="https://storage.googleapis.com/gpt-engineer-file-uploads/qyGlrqJHe9g2hyHsAc6ZZroRlyF2/uploads/1758515219868-ChatGPT Image Sep 21, 2025, 11_01_12 PM.png">
    
    <!-- Reduced Motion: apply class when user prefers reduced motion -->
    <script>
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        document.documentElement.classList.add('reduce-motion');
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </head>

  <body>
    <div id="root">
      <!-- Static loading screen - renders instantly before React loads -->
      <style>
        #app-loading-screen {
          position: fixed;
          inset: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #000000;
          z-index: 9999;
        }
        .flame-container {
          width: 96px;
          height: 96px;
          animation: bounce 2s ease-in-out infinite;
          filter: drop-shadow(0 0 20px rgba(251, 146, 60, 0.6)) drop-shadow(0 0 40px rgba(234, 88, 12, 0.4));
        }
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          25% { transform: translateY(-12px); }
          50% { transform: translateY(0); }
          75% { transform: translateY(-6px); }
        }
      </style>
      <div id="app-loading-screen">
        <div class="flame-container">
          <svg viewBox="0 0 64 64" width="100%" height="100%">
            <defs>
              <linearGradient id="flameGradientMain" x1="0%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" stop-color="#f97316" />
                <stop offset="40%" stop-color="#ea580c" />
                <stop offset="70%" stop-color="#dc2626" />
                <stop offset="100%" stop-color="#b91c1c" />
              </linearGradient>
              <linearGradient id="flameGradientInner" x1="0%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" stop-color="#fbbf24" />
                <stop offset="50%" stop-color="#f59e0b" />
                <stop offset="100%" stop-color="#f97316" />
              </linearGradient>
              <linearGradient id="flameGradientCore" x1="0%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" stop-color="#fef3c7" />
                <stop offset="50%" stop-color="#fcd34d" />
                <stop offset="100%" stop-color="#fbbf24" />
              </linearGradient>
            </defs>
            <path d="M32 4C32 4 16 20 16 36C16 44.8366 23.1634 52 32 52C40.8366 52 48 44.8366 48 36C48 20 32 4 32 4Z" fill="url(#flameGradientMain)"/>
            <path d="M32 14C32 14 22 26 22 38C22 43.5228 26.4772 48 32 48C37.5228 48 42 43.5228 42 38C42 26 32 14 32 14Z" fill="url(#flameGradientInner)"/>
            <path d="M32 24C32 24 27 32 27 40C27 42.7614 29.2386 45 32 45C34.7614 45 37 42.7614 37 40C37 32 32 24 32 24Z" fill="url(#flameGradientCore)"/>
          </svg>
        </div>
      </div>
    </div>
    
    <!-- Enhanced Service Worker Registration with User-Controlled Update Flow -->
    <script>
      if ('serviceWorker' in navigator) {
        let updateShown = false;

        // Listen for service worker messages
        navigator.serviceWorker.addEventListener('message', (event) => {
          if (!event.data || event.data.type !== 'SW_UPDATED' || updateShown) return;
          updateShown = true;

          const notification = document.createElement('div');
          notification.setAttribute('role', 'status');
          notification.style.cssText = 'position:fixed;top:16px;right:16px;z-index:9999;background:linear-gradient(135deg,#ff6b35,#f15a24);color:#fff;padding:12px 16px;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.15);width:260px;font-family:Inter,system-ui,sans-serif;';
          notification.innerHTML = `
            <div style="font-weight:600;margin-bottom:6px;">ðŸŽ‰ App Updated!</div>
            <div style="font-size:13px;opacity:0.9;margin-bottom:10px;">A new version is available. Refresh to see the latest features.</div>
            <button id="sw-refresh-btn" style="background:rgba(255,255,255,0.2);border:none;color:#fff;padding:8px 12px;border-radius:6px;font-weight:500;cursor:pointer;width:100%;">Refresh Now</button>
            <div id="sw-countdown" style="font-size:11px;opacity:0.7;margin-top:6px;text-align:center;">Auto-refresh in 30s</div>
          `;
          document.body.appendChild(notification);

          let userClicked = false;
          let countdown = 30;
          const countdownEl = notification.querySelector('#sw-countdown');
          const refreshBtn = notification.querySelector('#sw-refresh-btn');

          // Handle user clicking refresh
          refreshBtn.addEventListener('click', () => {
            userClicked = true;
            window.location.reload();
          });

          // Countdown timer for auto-refresh
          const timer = setInterval(() => {
            countdown--;
            if (countdownEl) countdownEl.textContent = 'Auto-refresh in ' + countdown + 's';
            if (countdown <= 0) {
              clearInterval(timer);
              if (!userClicked) window.location.reload();
            }
          }, 1000);
        });

        // Register service worker
        window.addEventListener('load', async () => {
          try {
            const registration = await navigator.serviceWorker.register('/sw.js');
            console.log('SW registered: ', registration);

            // Check for updates every 30 minutes (1800000ms) instead of 30 seconds
            setInterval(() => {
              registration.update();
            }, 1800000);

            // Listen for new service worker
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              if (newWorker) {
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    console.log('New service worker installed');
                  }
                });
              }
            });

          } catch (error) {
            console.log('SW registration failed: ', error);
          }
        });
      }

      // Force cache clear on critical updates - only clear app-related caches
      // Bump version (e.g., 1.0.3 -> 1.0.4) when breaking cache changes are needed
      if (localStorage.getItem('swipematch_last_clear') !== '2.0.0') {
        console.log('Clearing app caches for fresh content...');
        if ('caches' in window) {
          caches.keys().then(names => {
            names.forEach(name => {
              // Only delete caches with swipematch or tinderent prefix to avoid affecting other origins
              if (name.startsWith('swipematch-') || name.startsWith('tinderent-')) {
                caches.delete(name);
              }
            });
          });
        }
        localStorage.setItem('swipematch_last_clear', '2.0.0');
      }
    </script>
  </body>
</html>
